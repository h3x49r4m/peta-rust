<nav class="chapter-navigation" data-component="chapter_navigation" data-layout="{{ layout }}" data-collapsible="{{ collapsible }}">
  {% slot header %}
  <header class="chapter-navigation-header">
    <h3 class="chapter-navigation-title">Chapters</h3>
    {% if collapsible %}
    <button class="chapter-navigation-toggle" data-toggle>
      {% component "icon" with name="chevron-down" library="feather" size="sm" %}
      {% endslot %}
    </button>
    {% endif %}
  </header>
  {% endslot %}
  
  <div class="chapter-navigation-content" data-content>
    {% if show_progress %}
    <div class="chapter-navigation-progress">
      <div class="chapter-navigation-progress-bar">
        <div class="chapter-navigation-progress-fill" style="width: {{ (current_chapter / (chapters|length - 1)) * 100 }}%"></div>
      </div>
      <div class="chapter-navigation-progress-text">
        Chapter {{ current_chapter + 1 }} of {{ chapters|length }}
      </div>
    </div>
    {% endif %}
    
    <div class="chapter-navigation-list" data-list>
      {% for chapter in chapters %}
      <div class="chapter-navigation-item {% if loop.index0 == current_chapter %}chapter-navigation-item--active{% endif %}" data-chapter="{{ loop.index0 }}">
        <a href="{{ chapter.url }}" class="chapter-navigation-link" data-chapter-link>
          {% if show_numbers %}
          <span class="chapter-navigation-number">{{ loop.index }}</span>
          {% endif %}
          
          <div class="chapter-navigation-info">
            <span class="chapter-navigation-title">{{ chapter.title }}</span>
            {% if chapter.description %}
            <span class="chapter-navigation-description">{{ chapter.description | truncate(length: 80) }}</span>
            {% endif %}
          </div>
          
          {% if chapter.read_time %}
          <span class="chapter-navigation-meta">
            {% component "icon" with name="clock" library="feather" size="xs" %}
            {% endslot %}
            {{ chapter.read_time }}
          </span>
          {% endif %}
          
          {% if chapter.completed %}
          <span class="chapter-navigation-status chapter-navigation-status--completed">
            {% component "icon" with name="check-circle" library="feather" size="sm" %}
            {% endslot %}
          </span>
          {% endif %}
        </a>
        
        {% if layout == "accordion" and chapter.sections %}
        <div class="chapter-navigation-sections {% if loop.index0 == current_chapter %}chapter-navigation-sections--expanded{% endif %}" data-sections>
          {% for section in chapter.sections %}
          <a href="{{ section.url }}" class="chapter-navigation-section-link" data-section-link>
            <span class="chapter-navigation-section-title">{{ section.title }}</span>
            {% if section.completed %}
            <span class="chapter-navigation-section-status">
              {% component "icon" with name="check" library="feather" size="xs" %}
              {% endslot %}
            </span>
            {% endif %}
          </a>
          {% endfor %}
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
  
  {% slot footer %}
  <footer class="chapter-navigation-footer">
    {% if current_chapter > 0 %}
    <a href="{{ chapters[current_chapter - 1].url }}" class="chapter-navigation-nav-btn chapter-navigation-nav-btn--prev">
      {% component "icon" with name="chevron-left" library="feather" size="sm" %}
      {% endslot %}
      Previous
    </a>
    {% endif %}
    
    {% if current_chapter < chapters|length - 1 %}
    <a href="{{ chapters[current_chapter + 1].url }}" class="chapter-navigation-nav-btn chapter-navigation-nav-btn--next">
      Next
      {% component "icon" with name="chevron-right" library="feather" size="sm" %}
      {% endslot %}
    </a>
    {% endif %}
  </footer>
  {% endslot %}
</nav>