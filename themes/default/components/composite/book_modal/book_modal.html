<!-- Book Modal Component -->
<div class="book-modal-overlay" id="book-modal-overlay" data-component="book_modal">
  <div class="book-modal-container">
    <!-- Modal Header -->
    <div class="book-modal-header">
      <div class="book-modal-header-content">
        <h2 class="book-modal-title">{{ book_title }}</h2>
        {% if book_author %}
        <p class="book-modal-author">by {{ book_author }}</p>
        {% endif %}
      </div>
    </div>

    <!-- Modal Body -->
    <div class="book-modal-body">
      <!-- Book TOC - Floating component (inlined to avoid Tera template conflicts) -->
      <div class="book-toc-wrapper" data-component="book_toc">
        <!-- Toggle Button -->
        <button class="book-toc-toggle-btn" id="book-toc-toggle" aria-label="Toggle Table of Contents" aria-expanded="false">
          <svg class="toc-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>
        
        <!-- TOC Content Panel -->
        <div class="book-toc-panel" id="book-toc-panel">
          <div class="book-toc-header">
            <h3 class="book-toc-title">Contents</h3>
          </div>
          <div class="book-toc-content" id="book-toc-content">
            {% if book_toc %}
            {{ book_toc | safe }}
            {% else %}
            <p class="toc-empty">No chapters available</p>
            {% endif %}
          </div>
        </div>
      </div>
      
      <!-- Book Content -->
      <main class="book-modal-content">
        {% if content %}
        <div class="book-content" data-component="book_content">
          <div class="book-content-wrapper">
            {{ content | safe }}
          </div>
        </div>
        {% endif %}
      </main>
    </div>
  </div>
</div>