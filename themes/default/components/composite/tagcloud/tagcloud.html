<div class="tagcloud" data-component="tagcloud" data-variant="{{ variant }}">
  {% if prefix %}
  <div class="tagcloud-prefix">
    {% slot prefix %}{% endslot %}
  </div>
  {% endif %}
  
  <div class="tagcloud-tags" data-tagcloud-tags>
    {% if tags and tags|length > 0 %}
      {% set sorted_tags = tags | sort(attribute='count', reverse=true) %}
      {% for tag in sorted_tags|slice(0, max_tags) %}
        {% set weight = ((tag.count / sorted_tags[0].count) * 100) | round %}
        {% set size_class = get_tag_size_class(weight) %}
        
        <a href="/tags/{{ tag.name }}" 
           class="tagcloud-tag {{ size_class }}" 
           data-tag="{{ tag.name }}"
           data-count="{{ tag.count }}"
           data-weight="{{ weight }}"
           {% if not clickable %}tabindex="-1"{% endif %}>
          {{ tag.name }}
          {% if show_counts %}
          <span class="tagcloud-count">({{ tag.count }})</span>
          {% endif %}
        </a>
      {% endfor %}
    {% else %}
      <div class="tagcloud-empty">
        {% slot empty %}
        <p>No tags available.</p>
        {% endslot %}
      </div>
    {% endif %}
  </div>
  
  {% if suffix %}
  <div class="tagcloud-suffix">
    {% slot suffix %}{% endslot %}
  </div>
  {% endif %}
</div>

{% macro get_tag_size_class(weight) %}
  {% if weight >= 80 %}
    tagcloud-tag--xl
  {% elif weight >= 60 %}
    tagcloud-tag--lg
  {% elif weight >= 40 %}
    tagcloud-tag--md
  {% elif weight >= 20 %}
    tagcloud-tag--sm
  {% else %}
    tagcloud-tag--xs
  {% endif %}
{% endmacro %}